# å¿«é€Ÿå¼€å§‹ - ç”¨æˆ·ç³»ç»Ÿå‡çº§

## ğŸš€ å‡çº§æ­¥éª¤ï¼ˆ2åˆ†é’Ÿï¼‰

### æ­¥éª¤ 1: å¤‡ä»½æ•°æ®åº“ï¼ˆé‡è¦ï¼ï¼‰

```bash
mysqldump -u root -p blog_db > backup_$(date +%Y%m%d).sql
```

### æ­¥éª¤ 2: å‡çº§æ•°æ®åº“

```bash
mysql -u root -p blog_db < scripts/upgrade-db.sql
```

æˆ–è€…åœ¨æ•°æ®åº“å·¥å…·ä¸­æ‰§è¡Œ `scripts/upgrade-db.sql` çš„å†…å®¹ã€‚

### æ­¥éª¤ 3: éªŒè¯å‡çº§

```sql
-- æŸ¥çœ‹ç”¨æˆ·è¡¨ç»“æ„ï¼Œåº”è¯¥æœ‰ avatar, bio, role, status å­—æ®µ
DESCRIBE users;

-- æŸ¥çœ‹ç®¡ç†å‘˜ï¼Œid=1 çš„ç”¨æˆ·åº”è¯¥æ˜¯ admin
SELECT id, email, name, role FROM users;
```

```bash
npm run dev
```

### æ­¥éª¤ 5: æµ‹è¯•åŠŸèƒ½

1. **æµ‹è¯•ç®¡ç†å‘˜ç™»å½•**
   - æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:3000
   - ç‚¹å‡»å³ä¸Šè§’"ç™»å½•"æŒ‰é’®
   - ä½¿ç”¨æ‚¨åŸæœ‰çš„ç®¡ç†å‘˜è´¦æˆ·ç™»å½•
   - ç™»å½•æˆåŠŸåï¼Œç‚¹å‡»å³ä¸Šè§’å¤´åƒï¼Œåº”è¯¥èƒ½çœ‹åˆ°ï¼š
     - âœ… ä¸ªäººä¸­å¿ƒ
     - âœ… ç®¡ç†åå°ï¼ˆç´«è‰²æ ‡è¯†ï¼‰
     - âœ… é€€å‡ºç™»å½•

2. **æµ‹è¯•ä¸ªäººä¸­å¿ƒ**
   - ç‚¹å‡»"ä¸ªäººä¸­å¿ƒ"
   - åº”è¯¥çœ‹åˆ°ç´«è‰²çš„"ç®¡ç†å‘˜åŠŸèƒ½"åŒºåŸŸ
   - å¯ä»¥ç‚¹å‡»"è¿›å…¥åå°ç®¡ç†"è·³è½¬åˆ° `/admin/dashboard`

3. **æµ‹è¯•æ–°ç”¨æˆ·æ³¨å†Œ**
   - é€€å‡ºç™»å½•
   - ç‚¹å‡»å³ä¸Šè§’"æ³¨å†Œ"
   - æ³¨å†Œä¸€ä¸ªæµ‹è¯•è´¦æˆ·
   - ç™»å½•åè®¿é—®ä¸ªäººä¸­å¿ƒï¼Œåº”è¯¥**çœ‹ä¸åˆ°**ç®¡ç†å‘˜åŠŸèƒ½åŒºåŸŸ

## ğŸ“‹ å‡çº§æ£€æŸ¥æ¸…å•

å®Œæˆä»¥ä¸‹æ£€æŸ¥ç¡®ä¿å‡çº§æˆåŠŸï¼š

- [ ] æ•°æ®åº“å‡çº§è„šæœ¬æ‰§è¡ŒæˆåŠŸ
- [ ] users è¡¨æœ‰ `role`, `avatar`, `bio`, `status` å­—æ®µ
- [ ] comments è¡¨æœ‰ `user_id` å­—æ®µ
- [ ] è‡³å°‘æœ‰ä¸€ä¸ªç”¨æˆ·çš„ role æ˜¯ 'admin'
- [ ] åŸç®¡ç†å‘˜è´¦æˆ·å¯ä»¥ç™»å½•
- [ ] ç®¡ç†å‘˜ç™»å½•åèƒ½è®¿é—® `/admin/dashboard`
- [ ] ç®¡ç†å‘˜åœ¨ä¸ªäººä¸­å¿ƒèƒ½çœ‹åˆ°"ç®¡ç†åå°"æŒ‰é’®
- [ ] æ–°æ³¨å†Œç”¨æˆ·ä¸ºæ™®é€šç”¨æˆ·è§’è‰²
- [ ] é¦–é¡µå¯¼èˆªæ æ­£å¸¸æ˜¾ç¤ºç™»å½•/æ³¨å†ŒæŒ‰é’®
- [ ] è¯„è®ºåŠŸèƒ½è¦æ±‚ç™»å½•æ‰èƒ½å‘è¡¨

## ğŸ¯ æ–°åŠŸèƒ½æ¦‚è§ˆ

### ç”¨æˆ·åŠŸèƒ½
| åŠŸèƒ½ | è·¯ç”± | è¯´æ˜ |
|------|------|------|
| æ³¨å†Œ | `/register` | æ–°ç”¨æˆ·æ³¨å†Œï¼Œé»˜è®¤æ™®é€šç”¨æˆ· |
| ç™»å½• | `/login` | ç»Ÿä¸€ç™»å½•å…¥å£ |
| ä¸ªäººä¸­å¿ƒ | `/profile` | æŸ¥çœ‹/ç¼–è¾‘ä¸ªäººèµ„æ–™ |
| é€€å‡ºç™»å½• | å¯¼èˆªæ ä¸‹æ‹‰èœå• | å®‰å…¨é€€å‡º |

### ç®¡ç†å‘˜ä¸“å±
| åŠŸèƒ½ | ä½ç½® | è¯´æ˜ |
|------|------|------|
| ç®¡ç†åå°å…¥å£ | ä¸ªäººä¸­å¿ƒç´«è‰²åŒºåŸŸ | å¿«é€Ÿè·³è½¬åå° |
| ç®¡ç†åå° | å¯¼èˆªæ ä¸‹æ‹‰èœå• | ç›´æ¥è®¿é—®åå° |
| è¯„è®ºè‡ªåŠ¨å®¡æ ¸ | å‘è¡¨è¯„è®ºæ—¶ | ç®¡ç†å‘˜è¯„è®ºæ— éœ€å®¡æ ¸ |

### å¯¼èˆªæ 
- **æœªç™»å½•**: æ˜¾ç¤º"ç™»å½•"å’Œ"æ³¨å†Œ"æŒ‰é’®
- **å·²ç™»å½•ï¼ˆæ™®é€šç”¨æˆ·ï¼‰**: æ˜¾ç¤ºç”¨æˆ·å¤´åƒ + ä¸‹æ‹‰èœå•ï¼ˆä¸ªäººä¸­å¿ƒã€é€€å‡ºï¼‰
- **å·²ç™»å½•ï¼ˆç®¡ç†å‘˜ï¼‰**: æ˜¾ç¤ºç”¨æˆ·å¤´åƒ + ä¸‹æ‹‰èœå•ï¼ˆä¸ªäººä¸­å¿ƒã€ç®¡ç†åå°ã€é€€å‡ºï¼‰

## ğŸ¨ ç•Œé¢é¢„è§ˆ

### é¦–é¡µå¯¼èˆªï¼ˆæœªç™»å½•ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æˆ‘çš„åšå®¢          é¦–é¡µ  [ç™»å½•]  [æ³¨å†Œ]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¦–é¡µå¯¼èˆªï¼ˆå·²ç™»å½•ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æˆ‘çš„åšå®¢          é¦–é¡µ  [ğŸ‘¤ å¼ ä¸‰ â–¼]         â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                          â”‚ ä¸ªäººä¸­å¿ƒ     â”‚   â”‚
â”‚                          â”‚ ç®¡ç†åå°     â”‚   â”‚ï¼ˆä»…ç®¡ç†å‘˜ï¼‰
â”‚                          â”‚ é€€å‡ºç™»å½•     â”‚   â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸ªäººä¸­å¿ƒï¼ˆç®¡ç†å‘˜ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸ªäººä¸­å¿ƒ                        è¿”å›é¦–é¡µ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘¤  ç®¡ç†å‘˜                                  â”‚
â”‚      admin@blog.com                         â”‚
â”‚      ğŸŸ£ ç®¡ç†å‘˜  æ³¨å†Œäº 2024-01-01           â”‚
â”‚                                             â”‚
â”‚  ç®€ä»‹å†…å®¹...                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸŸ£ ç®¡ç†å‘˜åŠŸèƒ½                               â”‚
â”‚  [è¿›å…¥åå°ç®¡ç†] [æ–‡ç« ç®¡ç†] [è¯„è®ºç®¡ç†]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ç¼–è¾‘èµ„æ–™]                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ç¯å¢ƒå˜é‡

ç¡®ä¿ `.env.local` æ–‡ä»¶åŒ…å«ï¼š

```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=ä½ çš„å¯†ç 
DB_NAME=blog_db

# NextAuth é…ç½®
NEXTAUTH_SECRET=your-secret-key-here
NEXTAUTH_URL=http://localhost:3000
```

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜1: å‡çº§è„šæœ¬æ‰§è¡Œå¤±è´¥
**ç—‡çŠ¶**: æç¤ºå­—æ®µå·²å­˜åœ¨æˆ–å…¶ä»–é”™è¯¯

**è§£å†³**: è„šæœ¬ä½¿ç”¨äº† `IF NOT EXISTS` å’Œ `IF EXISTS`ï¼Œå¯ä»¥å®‰å…¨é‡å¤æ‰§è¡Œã€‚å¦‚æœä»æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯ã€‚

### é—®é¢˜2: ç™»å½•åçœ‹ä¸åˆ°ç®¡ç†åå°é€‰é¡¹
**åŸå› **: ç”¨æˆ· role ä¸æ˜¯ 'admin'

**è§£å†³**:
```sql
-- æ£€æŸ¥å½“å‰è§’è‰²
SELECT email, role FROM users WHERE email = 'æ‚¨çš„é‚®ç®±';

-- è®¾ç½®ä¸ºç®¡ç†å‘˜
UPDATE users SET role = 'admin' WHERE email = 'æ‚¨çš„é‚®ç®±';
```

### é—®é¢˜3: ä¸­é—´ä»¶æŠ¥é”™
**åŸå› **: next-auth token é…ç½®é—®é¢˜

**è§£å†³**: æ¸…é™¤æµè§ˆå™¨ cookiesï¼Œé‡æ–°ç™»å½•

### é—®é¢˜4: è¯„è®ºæ— æ³•æäº¤
**åŸå› **: æ–°ç‰ˆæœ¬è¦æ±‚ç™»å½•æ‰èƒ½è¯„è®º

**è§£å†³**: 
- ç™»å½•åå†è¯„è®º
- æˆ–ä¿®æ”¹ `components/CommentForm.tsx` å…è®¸æ¸¸å®¢è¯„è®º

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸
2. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
3. æŸ¥çœ‹æœåŠ¡å™¨ç»ˆç«¯è¾“å‡º
4. ç¡®è®¤ `.env.local` é…ç½®æ­£ç¡®

## ğŸ‰ å‡çº§å®Œæˆï¼

ç°åœ¨æ‚¨çš„åšå®¢ç³»ç»Ÿæ‹¥æœ‰ï¼š
- âœ… å®Œæ•´çš„ç”¨æˆ·æ³¨å†Œ/ç™»å½•ç³»ç»Ÿ
- âœ… ç”¨æˆ·ä¸ªäººä¸­å¿ƒ
- âœ… è§’è‰²æƒé™ç®¡ç†
- âœ… è¯„è®ºå…³è”ç”¨æˆ·
- âœ… å“åº”å¼å¯¼èˆªæ 
- âœ… å®‰å…¨çš„è·¯ç”±ä¿æŠ¤

å¼€å§‹ä½¿ç”¨æ–°åŠŸèƒ½å§ï¼ğŸš€
